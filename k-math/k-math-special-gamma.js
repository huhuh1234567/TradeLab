(function(){

	var GAMMA = 0.577215664901532860606512090082;

	var LANCZOS_G = 607.0 / 128.0;

	var DEFAULT_EPSILON = 10e-15;

	var LANCZOS = [
		0.99999999999999709182,
		57.156235665862923517,
		-59.597960355475491248,
		14.136097974741747174,
		-0.49191381609762019978,
		.33994649984811888699e-4,
		.46523628927048575665e-4,
		-.98374475304879564677e-4,
		.15808870322491248884e-3,
		-.21026444172410488319e-3,
		.21743961811521264320e-3,
		-.16431810653676389022e-3,
		.84418223983852743293e-4,
		-.26190838401581408670e-4,
		.36899182659531622704e-5,
	];

	var HALF_LOG_2_PI = 0.5 * Math.log(2.0 * Math.PI);

	var SQRT_TWO_PI = 2.506628274631000502;

	var C_LIMIT = 49;

	var S_LIMIT = 1e-5;

	var INV_GAMMA1P_M1_A0 = .611609510448141581788E-08;

	var INV_GAMMA1P_M1_A1 = .624730830116465516210E-08;

	var INV_GAMMA1P_M1_B1 = .203610414066806987300E+00;

	var INV_GAMMA1P_M1_B2 = .266205348428949217746E-01;

	var INV_GAMMA1P_M1_B3 = .493944979382446875238E-03;

	var INV_GAMMA1P_M1_B4 = -.851419432440314906588E-05;

	var INV_GAMMA1P_M1_B5 = -.643045481779353022248E-05;

	var INV_GAMMA1P_M1_B6 = .992641840672773722196E-06;

	var INV_GAMMA1P_M1_B7 = -.607761895722825260739E-07;

	var INV_GAMMA1P_M1_B8 = .195755836614639731882E-09;

	var INV_GAMMA1P_M1_P0 = .6116095104481415817861E-08;

	var INV_GAMMA1P_M1_P1 = .6871674113067198736152E-08;

	var INV_GAMMA1P_M1_P2 = .6820161668496170657918E-09;

	var INV_GAMMA1P_M1_P3 = .4686843322948848031080E-10;

	var INV_GAMMA1P_M1_P4 = .1572833027710446286995E-11;

	var INV_GAMMA1P_M1_P5 = -.1249441572276366213222E-12;

	var INV_GAMMA1P_M1_P6 = .4343529937408594255178E-14;

	var INV_GAMMA1P_M1_Q1 = .3056961078365221025009E+00;

	var INV_GAMMA1P_M1_Q2 = .5464213086042296536016E-01;

	var INV_GAMMA1P_M1_Q3 = .4956830093825887312020E-02;

	var INV_GAMMA1P_M1_Q4 = .2692369466186361192876E-03;

	var INV_GAMMA1P_M1_C = -.422784335098467139393487909917598E+00;

	var INV_GAMMA1P_M1_C0 = .577215664901532860606512090082402E+00;

	var INV_GAMMA1P_M1_C1 = -.655878071520253881077019515145390E+00;

	var INV_GAMMA1P_M1_C2 = -.420026350340952355290039348754298E-01;

	var INV_GAMMA1P_M1_C3 = .166538611382291489501700795102105E+00;

	var INV_GAMMA1P_M1_C4 = -.421977345555443367482083012891874E-01;

	var INV_GAMMA1P_M1_C5 = -.962197152787697356211492167234820E-02;

	var INV_GAMMA1P_M1_C6 = .721894324666309954239501034044657E-02;

	var INV_GAMMA1P_M1_C7 = -.116516759185906511211397108401839E-02;

	var INV_GAMMA1P_M1_C8 = -.215241674114950972815729963053648E-03;

	var INV_GAMMA1P_M1_C9 = .128050282388116186153198626328164E-03;

	var INV_GAMMA1P_M1_C10 = -.201348547807882386556893914210218E-04;

	var INV_GAMMA1P_M1_C11 = -.125049348214267065734535947383309E-05;

	var INV_GAMMA1P_M1_C12 = .113302723198169588237412962033074E-05;

	var INV_GAMMA1P_M1_C13 = -.205633841697760710345015413002057E-06;

	function logGamma(x){

		var ret;

		if (isNaN(x) || (x <= 0.0)) {
			ret = NaN;
		} else if (x < 0.5) {
			return logGamma1p(x) - Math.log(x);
		} else if (x <= 2.5) {
			return logGamma1p((x - 0.5) - 0.5);
		} else if (x <= 8.0) {
			var n = (Math.floor(x - 1.5))>>0;
			var prod = 1.0;
			for (var i = 1; i <= n; i++) {
				prod *= x - i;
			}
			return logGamma1p(x - (n + 1)) + Math.log(prod);
		} else {
			var sum = lanczos(x);
			var tmp = x + LANCZOS_G + .5;
			ret = ((x + .5) * Math.log(tmp)) - tmp +
				HALF_LOG_2_PI + Math.log(sum / x);
		}

		return ret;
	}

	exports.Gamma = {
		GAMMA: GAMMA,
		LANCZOS_G: LANCZOS_G
	};

})();